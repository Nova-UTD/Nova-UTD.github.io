<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Getting Things Rolling With Demo 1 | Nova</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Getting Things Rolling With Demo 1" />
<meta name="author" content="Will" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Getting started with autonomous cars can be scary. How do you start? We started in January with a simple goal: Travel from Point A to Point B. Every other factor would be simplified as much as possible. This led us to the following assumptions: Driving will occur in daytime, in good weather. A human will be behind the wheel at all times, ready to take over. This person will control the throttle and brake. The computer can only move the steering wheel. The computer will have access to processed, pre-recorded map data. The computer will be given its initial location and its goal location before it starts the trip." />
<meta property="og:description" content="Getting started with autonomous cars can be scary. How do you start? We started in January with a simple goal: Travel from Point A to Point B. Every other factor would be simplified as much as possible. This led us to the following assumptions: Driving will occur in daytime, in good weather. A human will be behind the wheel at all times, ready to take over. This person will control the throttle and brake. The computer can only move the steering wheel. The computer will have access to processed, pre-recorded map data. The computer will be given its initial location and its goal location before it starts the trip." />
<link rel="canonical" href="http://localhost:4000/d1-overview" />
<meta property="og:url" content="http://localhost:4000/d1-overview" />
<meta property="og:site_name" content="Nova" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-07-08T19:00:18-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Getting Things Rolling With Demo 1" />
<script type="application/ld+json">
{"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/res/logo.svg"},"name":"Will"},"url":"http://localhost:4000/d1-overview","headline":"Getting Things Rolling With Demo 1","dateModified":"2021-07-08T19:00:18-05:00","datePublished":"2021-07-08T19:00:18-05:00","author":{"@type":"Person","name":"Will"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/d1-overview"},"description":"Getting started with autonomous cars can be scary. How do you start? We started in January with a simple goal: Travel from Point A to Point B. Every other factor would be simplified as much as possible. This led us to the following assumptions: Driving will occur in daytime, in good weather. A human will be behind the wheel at all times, ready to take over. This person will control the throttle and brake. The computer can only move the steering wheel. The computer will have access to processed, pre-recorded map data. The computer will be given its initial location and its goal location before it starts the trip.","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=2c08cfec5a015887cc7c330ff079a09755b76a56">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <link rel="icon" type="image/png" href="/assets/favicon.png"/>
  
    <script>
      function cb(response) {
          document.getElementById('visits').innerText = response.value;
      }
      </script>
      <script async src="https://api.countapi.xyz/hit/voltron-utd.github.io/d1-overview<?callback=visitcb"></script>
      <script>
var xhr = new XMLHttpRequest();
xhr.open("GET", "https://api.countapi.xyz/hit/voltron-utd.github.io/"+"/d1-overview".replace(/\\|\//g,''));
xhr.responseType = "json";
xhr.onload = function() {
    document.getElementById('visits').innerText = this.response.value;
}
xhr.send();
      </script>
    </head>
  <body>
    <div class="wrapper">
      <header>
        <a href="http://localhost:4000/">
          
            <img src="/assets/res/logo.svg" alt="Logo" />
          
        </a>
        

        <p>Driving is hard, but humans make it look easy.  We're <b>UT Dallas's applied autonomous driving project</b>, and we're making driving look easier than ever.</p>
        <div><svg height="16" class="octicon octicon-home" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.156 1.835a.25.25 0 00-.312 0l-5.25 4.2a.25.25 0 00-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 01.75-.75h3.5a.75.75 0 01.75.75v5.25h2.75a.25.25 0 00.25-.25V6.23a.25.25 0 00-.094-.195l-5.25-4.2zM6.906.664a1.75 1.75 0 012.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0113.25 15h-3.5a.75.75 0 01-.75-.75V9H7v5.25a.75.75 0 01-.75.75h-3.5A1.75 1.75 0 011 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2h-.001z"></path></svg> ECSW 1.460 & 2.445</div>
        <a href="https://github.com/Nova-UTD"><svg height="16" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg> GitHub</a>
        <br>
        <a href="https://www.youtube.com/channel/UCoUScn3Hiib23wGSLbo94PQ"><svg height="16" class="octicon octicon-video" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path fill-rule="evenodd" d="M1.75 3.5a.25.25 0 00-.25.25v8.5c0 .138.112.25.25.25h12.5a.25.25 0 00.25-.25v-8.5a.25.25 0 00-.25-.25H1.75zM0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0114.25 14H1.75A1.75 1.75 0 010 12.25v-8.5z"></path><path d="M6 10.559V5.442a.25.25 0 01.379-.215l4.264 2.559a.25.25 0 010 .428l-4.264 2.559A.25.25 0 016 10.559z"></path></svg> YouTube</a>
        <br>
        <a href="https://www.instagram.com/nova.utd/"><svg height="16" class="octicon octicon-image" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path fill-rule="evenodd" d="M1.75 2.5a.25.25 0 00-.25.25v10.5c0 .138.112.25.25.25h.94a.76.76 0 01.03-.03l6.077-6.078a1.75 1.75 0 012.412-.06L14.5 10.31V2.75a.25.25 0 00-.25-.25H1.75zm12.5 11H4.81l5.048-5.047a.25.25 0 01.344-.009l4.298 3.889v.917a.25.25 0 01-.25.25zm1.75-.25V2.75A1.75 1.75 0 0014.25 1H1.75A1.75 1.75 0 000 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0016 13.25zM5.5 6a.5.5 0 11-1 0 .5.5 0 011 0zM7 6a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> Instagram</a>
        <br>
        <a href="https://www.linkedin.com/company/nova-utd/">
          <img src="/assets/res/linked-in-logo.png" alt="LinkedIn" style="width: 16px; height: 16px; margin-right: 5px;">LinkedIn</a>
        <br>
        <a href="mailto:project.nova@utdallas.edu"><svg height="16" class="octicon octicon-mail" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true"><path fill-rule="evenodd" d="M1.75 2A1.75 1.75 0 000 3.75v.736a.75.75 0 000 .027v7.737C0 13.216.784 14 1.75 14h12.5A1.75 1.75 0 0016 12.25v-8.5A1.75 1.75 0 0014.25 2H1.75zM14.5 4.07v-.32a.25.25 0 00-.25-.25H1.75a.25.25 0 00-.25.25v.32L8 7.88l6.5-3.81zm-13 1.74v6.441c0 .138.112.25.25.25h12.5a.25.25 0 00.25-.25V5.809L8.38 9.397a.75.75 0 01-.76 0L1.5 5.809z"></path></svg> project.nova@utdallas.edu</a>
        
        <br>
        <button class="button" style="width: 100%" onclick="location.href='https://nova-utd.github.io/navigator/'">üß≠ Navigator docs</button>
        <div><br>
          <!-- <a href="/join" class="button" target="_blank" style="width: 50%;"">Join us!</a></br> -->

        </div>
        <!--  
        
        <p class="view"><a href="https://github.com/Nova-UTD/Nova-UTD.github.io">View the Project on GitHub <small>Nova-UTD/Nova-UTD.github.io</small></a></p>
        

        
        <p class="view"><a href="https://github.com/Nova-UTD">View My GitHub Profile</a></p>
         -->
        <!-- 
        <h3>Openings</h3>
        <p>
          We're currently looking for a <a href="https://nova-utd.github.io/join#pr-director">PR director</a> and a <a href="https://nova-utd.github.io/join#firmware-technician">firmware technician</a>. Send us an application! We'd love to hear from you.
        </p>
         -->
        <h3>Latest posts</h3>
        
          <a href="/2023/02/13/Planning-with-cost-maps.html">Planning with cost maps</a> <small>2/13/23</small><br/>
        
          <a href="/2023/02/02/What's-up-with-Nova.html">What's up with Nova?</a> <small>2/2/23</small><br/>
        
          <a href="/2022/10/23/New-members.html">New members (and goodbyes)</a> <small>10/23/22</small><br/>
        
          <a href="/2022/08/27/Why-we-like-Nova-(Video).html">Why we like Nova (video)</a> <small>8/27/22</small><br/>
        
          <a href="/2022/03/03/Two-months-left.html">Two months left!</a> <small>3/3/22</small><br/>
        <br/>
        <h3><a href="/posts">All posts ‚ü∂</a></h3>
        <h3><a href="/assets/pdf/annual_plan_22_23.pdf">Annual plan ‚ü∂</a></h3>
        <hr/>

        <h3></h3>
        <h3></h3>
        
      </header>
      <section>

      

      <small>8 July 2021</small>
<h1>Getting Things Rolling With Demo 1</h1>

<p class="view">by Will</p>

<p>Getting started with autonomous cars can be scary. How do you start? We started in January with a simple goal: Travel from Point A to Point B. Every other factor would be simplified as much as possible. This led us to the following assumptions:</p>
<ul>
  <li>Driving will occur in daytime, in good weather.</li>
  <li>A human will be behind the wheel at all times, ready to take over.</li>
  <li>This person will control the throttle and brake.</li>
  <li>The computer can only move the steering wheel.</li>
  <li>The computer will have access to processed, pre-recorded map data.</li>
  <li>The computer will be given its initial location and its goal location before it starts the trip.</li>
</ul>

<p>We also defined a clear success condition, where all of the following are met:</p>
<ul>
  <li>The car should travel from Point A to Point B.</li>
  <li>Only the computer should apply any control whatsoever to the steering wheel for the duration of the trip.</li>
  <li>The car should remain in the appropriate lane.</li>
</ul>

<p>Finally, to meet the above criteria, we outlined five questions that demanded our attention:</p>
<ol>
  <li>What does the map look like?</li>
  <li>Where am I on the map?</li>
  <li>Where is my destination on the map?</li>
  <li>What is the best path from my location to my destination?</li>
  <li>How can I translate this path into steering angles?</li>
</ol>

<p>Breaking our goal down into these five questions made things more clear and approachable.</p>

<h2 id="tools-we-used">Tools we used</h2>
<h3 id="software">Software</h3>
<p>We‚Äôre lucky that a number of autonomous car ‚Äúplatforms‚Äù are publicly available for for researchers to use. These platforms offer implementations of popular algorithms for tasks like mapping and control. Platforms include <a href="https://github.com/commaai/openpilot">openpilot</a>, <a href="https://www.apollo.auto">apollo</a>, and a few others. But don‚Äôt be fooled like I was‚Äì using this software isn‚Äôt as easy as downloading a file and running it. Integration is an arduous process, no matter what platform you choose.</p>

<p>We ultimately decided to use <a href="https://www.autoware.auto">Autoware.Auto</a>. Autoware is a really transparant and easily extensible platform to adopt. It runs off a popular framework called the Robot Operating System, or ROS. Adding features on top of Autoware is as simple as writing our own ROS ‚Äúnode‚Äù.</p>

<h3 id="electronic-steering-and-can">Electronic Steering and CAN</h3>
<p>To steer the vehicle programatically, we used an <abbr title="electronic power-assisted steering">EPAS</abbr> system provided by <a href="https://www.dcemotorsport.com/Home/EPAS">DCE Motorsport</a>. The system includes a powerful motor that fits around the car‚Äôs steering column. It also includes a simple computer called an ‚ÄúECU‚Äù that controls the motor.</p>

<p>To send our commands from our onboard computer to the EPAS ECU, we used a <a href="https://canable.io/">CANable Pro</a>. All modern cars use <abbr title="Controller Area Networks">CAN</abbr> to send data to and from components‚Äì signals to turn on the blinkers, honk the horn, and so on. The CANable allows us to connect to our car‚Äôs CAN network and send steering commands over it, which the EPAS then receives.</p>

<h3 id="on-board-computing">On-board computing</h3>
<p>We used an <a href="https://developer.nvidia.com/embedded/jetson-agx-xavier-developer-kit">NVIDIA Jetson AGX Xavier</a> to run our entire stack. We didn‚Äôt optimize our code to run efficiently on the Xavier‚Äôs GPU, but we still achieved decent performance.</p>

<p>The Xavier is power efficient, which is an important consideration since our vehicle‚Äôs batteries aren‚Äôt limitless. Strapping a big GPU workstation to the roof would not have worked.</p>

<h3 id="simulation">Simulation</h3>
<p>We tested our code in a simulator before testing on the car. We used the <a href="https://www.svlsimulator.com/">SVL Simulator</a>, which can generate highly realistic environments. We ran all of this on a local server.</p>

<p>A nice thing about our code is that it doesn‚Äôt care whether it‚Äôs run in the simulator or on the real car. Our software‚Äôs only real-time inputs are the Lidar streams, which are provided by the simulator in the same way that they are by the car.</p>

<h2 id="1-what-does-the-map-look-like">1. What does the map look like?</h2>
<p><img src="/assets/res/d1-overview_maps.jpg" alt="Our map has two layers: 3D and labelled" />
Our map is split into two parts: A 3D map and a labelled map.</p>

<p>In the 3D map, a driver manually drives through the unmapped area and collects data from the car‚Äôs Lidar sensors. The data is then stitched together into a unified map file in a process known as <a href="https://en.wikipedia.org/wiki/Simultaneous_localization_and_mapping">SLAM</a>. 3D maps are great at describing the texture of an environment. We can line up our 3D map with real-time Lidar streams later on, and that provides us with an accurate location estimate. 3D points combined together are often called ‚Äúpointclouds‚Äù, so we commonly refer to 3D maps as ‚Äúpointcloud maps‚Äù or ‚ÄúPCD maps‚Äù.</p>

<p>The labelled map gives <em>context</em> to our 3D data. Without it, a street curb is indistiguishable from a speed bump. The vast majority of labelled maps, including ours, are labelled by humans. These maps provide the location of stop signs, crosswalks, and traffic lights. They can store speed limits, road closures, even the locations of soccer fields. Most importantly, the labelled map tells us where lanes are located and how they‚Äôre connected. In other words, this map describes the road network. Examples of labelled maps include Google Maps and <a href="https://www.openstreetmap.org/search?query=University%20of%20Texas%20Dallas#map=16/32.9876/-96.7511">Open Street Map</a>. Our maps use a specific format provided by the ‚ÄúLanelet‚Äù library, so we refer to our labelled maps as Lanelet maps.</p>

<p>When we combine the pointcloud and Lanelet maps together, we create a rich description of our environment. This pointcloud-Lanelet double whammy is often called an ‚ÄúHD‚Äù map.</p>

<h2 id="2-where-am-i-on-the-map">2. Where am I on the map?</h2>
<p>Researchers call this problem ‚Äúlocalization‚Äù. The most popular localization tool for everyday use is GPS (broadly called GNSS). GPS is not accurate or reliable enough for autonomous cars. Instead, most algorithms take GPS data as a starting point, then refine things with other data (usually LIDAR, stereo cameras).</p>

<p>We use an algorithm called Normal Distribution Transforms (NDT) to refine an initial location guess into an accurate result using real-time Lidar data and our 3D map. Specifically, we use Autoware.Auto‚Äôs implementation of NDT. Find more in <a href="https://youtu.be/g2YURb-d9vY?t=2532">this Autoware lecture</a>. The original NDT paper is <a href="https://ieeexplore.ieee.org/document/1249285">available here</a>.</p>

<p>The basic steps of NDT are:</p>
<ol>
  <li>Divide our prerecorded 3D map into a uniform grid.</li>
  <li>For each cell in our grid, calculate the average of all the points, along with the covariance. This makes our map much less complex, while still providing general information on how the points are dispersed within the map.</li>
  <li>Take a real-time Lidar feed from the vehicle and place it onto our map using an initial guess (supplied by a passenger in Demo 1‚Äôs case).</li>
  <li>Move our placed points around until they line up well with our grid of covariances (our processed 3D map).</li>
  <li>Once our points are aligned, since we know where we are relative to our lidar feed (we‚Äôre in the center of the feed) and where our feed is on the map, we then know where we are on the map.</li>
</ol>

<h2 id="3-where-is-my-destination-on-the-map">3. Where is my destination on the map?</h2>
<p>This one is simple. Since we already have a map from #1, passengers just select a point on the map. This point is stored at our goal pose.</p>

<h2 id="4-what-is-the-best-path-from-my-location-to-my-destinaton">4. What is the best path from my location to my destinaton?</h2>
<p>Imagine you‚Äôre looking for a restaurant that your friend told you about, and you‚Äôve gotten lost. You stop and ask for directions, which are something like, ‚ÄúGo down McKinney Road, then turn right on Rose Parkway, then turn left on‚Ä¶‚Äù These general directions, just a sequence of streets to take, is generally good enough for humans.</p>

<p>In Voltron, we use a <em>route planner</em> to calculate this sequence of streets using our Lanelet map. It basically generates a sequence like a human would, like <code class="language-plaintext highlighter-rouge">[McKinney Road, Rose Parkway...]</code>. But this isn‚Äôt specific enough for computers. We need to refine these general directions into an exact line (curve) that the car follows. This refinement is done by our <em>path planner</em>.</p>

<p>We make the following distinction between ‚Äúroute‚Äù and ‚Äúpath‚Äù: routes provide general directions while paths are exact curves for the car to drive along. Paths can easily adapt to, say, drive around potholes.</p>

<h2 id="5-how-can-i-translate-this-path-into-steering-angles">5. How can I translate this path into steering angles?</h2>
<p>At this point we know our current location (from #2) and the path we‚Äôd like to follow (from #4). We feed this information into a <em>steering controller</em> that turns this data into a steering angle.</p>

<p>Once we have our target steering angle, we feed it along with our current steering angle into a low-level PID controller. This calculates how much torque to apply to the steering wheel (literally how hard to turn the wheel, and it what direction). Finally, we translate this into a command to send to the steering motor. That‚Äôs it!</p>


<!-- 
  <small>tags: <em></em></small>
 -->


      </section>
      <footer>
        <!-- <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a> This page has <span id="visits"></span> views.</small></p> -->
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
    
  </body>
  <footer>
      
      
    </footer>
</html>
